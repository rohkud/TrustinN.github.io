<!DOCTYPE html>
<html>
    <head>
        <title>Project 1: Images of the Russian Empire</title>
        <link rel="stylesheet" href="style.css" />
    </head>
    <body>
        <div class="centered">
            <h2>Aligning Images with Exhaustive Search</h2>
            <p>
                Using an exhaustive search given a window [-z, z], the algorithm loops over the x and y axis to determine a shift (dx, dy) such that dx, dy are in [-z, z]. The ideal shift is chosen by a given metric, two of which I used for the project are sum of squared differences and the zero-normalized correlation coefficient. The ZNCC metric is useful for varying brightnesses in the channels, as the images are first normalized before maximizing their dot product. The exhaustive search is effective for small images such as the jpg files.
            </p>
        </div>
        <div class="center_images">
            <p>
                <img src="../media/exhaustive_ex/cathedral.jpg" alt="cathedral" width="300" height="300"></img>
                <img src="../media/exhaustive_ex/monastery.jpg" alt="cathedral" width="300" height="300"></img>
                <img src="../media/exhaustive_ex/tobolsk.jpg" alt="cathedral" width="300" height="300"></img>
            </p>
        </div>
        <div class="centered">
            <embed src="../media/exhaustive_ex/data.txt" alt="runtime data" width="100%">
        </div>

        <div class="centered">
            <h2>Runtime Data</h2>
            The output format is: image_name (ag_disp, ar_disp, runtime).
            <ul>
                <li>image_name: Name of the image</li>
                <li>ag_disp: Displacement of the green channel to align with the blue channel. This is a tuple of the form (dx, dy) such that <span class="nobr">np.roll(g, ag_disp, (1, 0))</span> is the realigned green channel.</li>
                <li>ar_disp: Displacement of the red channel to align with the blue channel. This is a tuple of the form (dx, dy) such that <span class="nobr">np.roll(r, ar_disp, (1, 0))</span> is the realigned red channel.</li>
                <li>runtime: Runtime in seconds.</li>
            </ul>
        </div>

        <div class="centered">
            <h2>Image Pyramid</h2>
            <p>
                For larger images, larger windows will slow down the result. Using an image pyramid, we can recursively downsample the image (by a factor of 2) to a given depth, at each step, aligning the image and returning the shift. Propagation upwards will account for the total displacement of the image, which we can use to shift the image. This makes the process much faster, as at a depth (d), determining the ideal displacement is fastest, and accounts for (# pixel shifts) * 2^d of the displacement. Although faster, this algorithm struggles with the borders that are present in some images. This affects the metric used, making the result inaccurate, especially on train.tif, lady.tif, and emir.tif.
            </p>
        </div>
        <div class="center_images">
            <p>
                <img src="../media/img_pyramid_ex/harvesters.jpg" alt="harvesters" width="300" height="300"></img>
                <img src="../media/img_pyramid_ex/monastery.jpg" alt="monastery" width="300" height="300"></img>
                <img src="../media/img_pyramid_ex/train.jpg" alt="train" width="300" height="300"></img>
                <img src="../media/img_pyramid_ex/emir.jpg" alt="emir" width="300" height="300"></img>
            </p>
            <div class="centered">
                <embed src="../media/img_pyramid_ex/data.txt" alt="runtime data" width="100%" height="100%">
            </div>
        </div>

        <div class="centered">
            <h2>Edge Detection for Alignment</h2>
            <p>
                One improvement is to use the sobel filter to detect edges in the image. We can preprocess the image with the filter, feed this into our alignment algorithm and obtain a result more resistant to border artifacts.
            </p>
        </div>
        <div class="center_images">
            <p>
                <img src="../media/sobel_ex/harvesters.jpg" alt="harvesters" width="300" height="300"></img>
                <img src="../media/sobel_ex/monastery.jpg" alt="monastery" width="300" height="300"></img>
                <img src="../media/sobel_ex/train.jpg" alt="train" width="300" height="300"></img>
                <img src="../media/sobel_ex/emir.jpg" alt="emir" width="300" height="300"></img>
            </p>
            <div class="centered">
                <embed src="../media/sobel_ex/data.txt" alt="runtime data" width="100%" height="100%">
            </div>
        </div>

        <div class="centered">
            <h2> Naive Cropping </h2>
            <p>
                To achieve stronger results, cropping the image by 15% on all sides can remove the issue.
            </p>
        </div>
        <div class="center_images">
            <p>
                <img src="../media/border_crop_ex/harvesters.jpg" alt="harvesters" width="300" height="300"></img>
                <img src="../media/border_crop_ex/monastery.jpg" alt="monastery" width="300" height="300"></img>
                <img src="../media/border_crop_ex/train.jpg" alt="train" width="300" height="300"></img>
                <img src="../media/border_crop_ex/emir.jpg" alt="emir" width="300" height="300"></img>
            </p>
            <div class="centered">
                <embed src="../media/border_crop_ex/data.txt" alt="runtime data" width="100%" height="100%">
            </div>
        </div>
    </body>

</html>
